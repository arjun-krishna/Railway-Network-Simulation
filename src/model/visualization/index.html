<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Railway Network Visualization</title>

<script src="./js/d3.v3.min.js" charset="utf-8"></script>
<script src="./js/topojson.v1.min.js"></script>
<script src="./js/d3.tip.v0.6.3.js"></script>

<style type="text/css">
	.feature {
		fill: none;
		stroke: grey;
		stroke-width: 1px;
			stroke-linejoin: round;
	}
	.mesh {
		fill: none;
			stroke: lightgrey;
			stroke-width: 2px;
			stroke-linejoin: round;
	}
	h1 {
		font-family: sans-serif;
	}
</style>
</head>
<body>


<script type="text/javascript">

// var width = 950,
// 		height = 550;


var width = 880,
		height = 700;

// set projection
var projection = d3.geo.mercator();

// create path variable
var path = d3.geo.path()
		.projection(projection);

// place - google-coord (x N,y E) value
transform_coordinates = function(projection,place) {

	// To plot co-ordinates from google-coordinates
	// pick the co-ord and reverse it 
	// and then project it 

	// example :
	// bangalore - 12.9783° N, 77.5684° E
	// ban = [12.9783,77.5684];
	// ban_coord = ban.reverse();
	// ban_coord = projection(ban_coord);

	return projection(place.reverse());
}

d3.json("../../data/india.json", function(error, topo) { 

		console.log(topo);
		states = topojson.feature(topo, topo.objects.india).features
		
		// set projection parameters
		projection
			.scale(1100)
			.translate([-1000,800]);

		// create svg variable
		var svg = d3.select("body").append("svg")
						.attr("width", width)
						.attr("height", height);


		ban = [12.9783,77.5684];
		ban_coord = transform_coordinates(projection,ban);

		del = [28.6609677,77.2276704];
		del_coord = transform_coordinates(projection,del);

		// add states from topojson
		svg.selectAll("path")
			.data(states).enter()
			.append("path")
			.attr("class", "feature")
			.style("fill", "steelblue")
			.attr("d", path);

		// put boarder around states 
		svg.append("path")
			.datum(topojson.mesh(topo, topo.objects.india, function(a, b) { return a !== b; }))
			.attr("class", "mesh")
			.attr("d", path);


		// plot co-ordinates
		svg.selectAll("circle")
			.data([ban_coord,del_coord]).enter()
			.append("circle")
			.attr("cx", function (d) { return d[0]; })
			.attr("cy", function (d) { return d[1]; })
			.attr("r", "2px")
			.attr("fill", "red")

		// edgeList contains array of edges
		// each edge has a vertice which is a co-ordinate 

		edgeL = [[ban_coord,del_coord]]

		// plot the edges
		svg.selectAll("line")
			.data(edgeL).enter()
			.append('line')
			.style('stroke', 'black')
			.style('stroke-width','2px')
			.attr('x1', function(edge) { return edge[0][0] })
			.attr('y1', function(edge) { return edge[0][1] })
			.attr('x2', function(edge) { return edge[1][0] })
			.attr('y2', function(edge) { return edge[1][1] });

});

</script>
		
</body>
</html>